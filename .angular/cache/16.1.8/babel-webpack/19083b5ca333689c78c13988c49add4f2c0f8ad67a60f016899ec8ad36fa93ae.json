{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { UntypedFormGroup, UntypedFormControl, Validators } from '@angular/forms';\nexport let SuppliersDetailsComponent = class SuppliersDetailsComponent {\n  constructor(financeService, route, _snackBar) {\n    this.financeService = financeService;\n    this.route = route;\n    this._snackBar = _snackBar;\n    this.currentYear = new Date().getFullYear();\n    this.custForm = new UntypedFormGroup({\n      pcode: new UntypedFormControl('', [Validators.required]),\n      custName: new UntypedFormControl('', [Validators.required]),\n      custCR: new UntypedFormControl('', [Validators.required]),\n      custStatus: new UntypedFormControl('', [Validators.required]),\n      custTaxNo: new UntypedFormControl('', [Validators.required]),\n      custPhone1: new UntypedFormControl('', [Validators.required]),\n      custPhone2: new UntypedFormControl('', [Validators.required]),\n      custEmail: new UntypedFormControl('', [Validators.required]),\n      custAdd1: new UntypedFormControl('', [Validators.required]),\n      custAdd2: new UntypedFormControl('', [Validators.required]),\n      custAdd3: new UntypedFormControl('', [Validators.required]),\n      contactId: new UntypedFormControl('', [Validators.required]),\n      contactPerson: new UntypedFormControl('', [Validators.required]),\n      contactPhone1: new UntypedFormControl('', [Validators.required]),\n      contactPhone2: new UntypedFormControl('', [Validators.required]),\n      contactEmail: new UntypedFormControl('', [Validators.required]),\n      contactAddress1: new UntypedFormControl('', [Validators.required]),\n      contactAddress2: new UntypedFormControl('', [Validators.required]),\n      contactAddress3: new UntypedFormControl('', [Validators.required])\n    });\n  }\n  ngOnInit() {\n    if (this.route.snapshot.params.id === 'new') {\n      this.newForm();\n    } else {\n      this.getData(this.route.snapshot.params.id);\n    }\n  }\n  getData(pcode) {\n    this.refreshForm();\n    this.financeService.getSupplierDetailFromPcode(String(this.currentYear), pcode).subscribe(res => {\n      console.log(res);\n      this.financeService.getPartyDetailFromPCODE(pcode).subscribe(resp => {\n        console.log(resp);\n        this.custForm.patchValue({\n          pcode: res.recordset[0].PCODE,\n          custName: res.recordset[0].CUST_NAME,\n          custCR: res.recordset[0].CR_CPR,\n          custStatus: res.recordset[0].STATUS,\n          custTaxNo: res.recordset[0].TAX_1_NO,\n          custPhone1: res.recordset[0].PHONE1,\n          custPhone2: res.recordset[0].PHONE2,\n          custEmail: res.recordset[0].EMAIL,\n          custAdd1: res.recordset[0].ADD1,\n          custAdd2: res.recordset[0].ADD2,\n          custAdd3: res.recordset[0].ADD3,\n          contactId: resp.recordset[0].PARTY_ID,\n          contactPerson: resp.recordset[0].NAME,\n          contactPhone1: resp.recordset[0].PHONE1,\n          contactPhone2: resp.recordset[0].PHONE2,\n          contactEmail: resp.recordset[0].EMAIL_ID,\n          contactAddress1: resp.recordset[0].ADD1,\n          contactAddress2: resp.recordset[0].ADD2,\n          contactAddress3: resp.recordset[0].ADD3\n        });\n      }, err => {\n        console.log(err);\n        this.custForm.patchValue({\n          pcode: res.recordset[0].PCODE,\n          custName: res.recordset[0].CUST_NAME,\n          custCR: res.recordset[0].CR_CPR,\n          custStatus: res.recordset[0].STATUS,\n          custTaxNo: res.recordset[0].TAX_1_NO,\n          custPhone1: res.recordset[0].PHONE1,\n          custPhone2: res.recordset[0].PHONE2,\n          custEmail: res.recordset[0].EMAIL,\n          custAdd1: res.recordset[0].ADD1,\n          custAdd2: res.recordset[0].ADD2,\n          custAdd3: res.recordset[0].ADD3\n        });\n      });\n    });\n  }\n  newForm() {\n    this.financeService.getCustomerCount().subscribe(res => {\n      console.log(res);\n      this.financeService.getMaxParty().subscribe(resp => {\n        console.log(resp);\n        const pcode = 'L012-000' + res.recordset[0].COUNT;\n        const partyid = Number(resp.recordset[0].COUNT) + 1;\n        this.custForm = new UntypedFormGroup({\n          pcode: new UntypedFormControl(pcode, [Validators.required]),\n          custName: new UntypedFormControl('', [Validators.required]),\n          custCR: new UntypedFormControl('', [Validators.required]),\n          custStatus: new UntypedFormControl('', [Validators.required]),\n          custTaxNo: new UntypedFormControl('', [Validators.required]),\n          custPhone1: new UntypedFormControl('', [Validators.required]),\n          custPhone2: new UntypedFormControl('', [Validators.required]),\n          custEmail: new UntypedFormControl('', [Validators.required]),\n          custAdd1: new UntypedFormControl('', [Validators.required]),\n          custAdd2: new UntypedFormControl('', [Validators.required]),\n          custAdd3: new UntypedFormControl('', [Validators.required]),\n          contactId: new UntypedFormControl(String(partyid), [Validators.required]),\n          contactPerson: new UntypedFormControl('', [Validators.required]),\n          contactPhone1: new UntypedFormControl('', [Validators.required]),\n          contactPhone2: new UntypedFormControl('', [Validators.required]),\n          contactEmail: new UntypedFormControl('', [Validators.required]),\n          contactAddress1: new UntypedFormControl('', [Validators.required]),\n          contactAddress2: new UntypedFormControl('', [Validators.required]),\n          contactAddress3: new UntypedFormControl('', [Validators.required])\n        });\n      });\n    });\n  }\n  submitForm() {\n    const data = this.custForm.value;\n    this.financeService.getCustomerDetailFromPcode(String(this.currentYear), data.pcode).subscribe(res => {\n      console.log(res);\n      this.financeService.updateOPBAL(data.pcode, data.custName, data.custCR, 'S', data.custAdd1, data.custAdd2, data.custAdd3, data.custPhone1, data.custPhone2, data.custEmail, data.custStatus, String(this.currentYear), data.custTaxNo);\n    }, err => {\n      console.log(err);\n      this.financeService.postOPBAL(data.pcode, data.custName, data.custCR, 'S', data.custAdd1, data.custAdd2, data.custAdd3, data.custPhone1, data.custPhone2, data.custEmail, data.custStatus, String(this.currentYear), data.custTaxNo);\n    });\n    this.financeService.getPartyDetailFromPartyId(data.contactId).subscribe(res => {\n      console.log(res);\n      this.financeService.updateContact(data.contactId, data.contactPerson, 'S', data.contactAddress1, data.contactAddress2, data.contactAddress3, data.contactPhone1, data.contactPhone2, data.contactEmail, data.pcode);\n    }, err => {\n      console.log(err);\n      this.financeService.postContact(data.contactId, data.contactPerson, 'S', data.contactAddress1, data.contactAddress2, data.contactAddress3, data.contactPhone1, data.contactPhone2, data.contactEmail, data.pcode);\n    });\n    this._snackBar.open(\"Data Successfully Updated!\", \"OK\");\n    this.getData(data.pcode);\n  }\n  copyToContact() {\n    const data = this.custForm.value;\n    this.custForm.patchValue({\n      contactPerson: data.custName,\n      contactPhone1: data.custPhone1,\n      contactPhone2: data.custPhone2,\n      contactEmail: data.custEmail,\n      contactAddress1: data.custAdd1,\n      contactAddress2: data.custAdd2,\n      contactAddress3: data.custAdd3\n    });\n  }\n  refreshForm() {\n    this.custForm = new UntypedFormGroup({\n      pcode: new UntypedFormControl('', [Validators.required]),\n      custName: new UntypedFormControl('', [Validators.required]),\n      custCR: new UntypedFormControl('', [Validators.required]),\n      custStatus: new UntypedFormControl('', [Validators.required]),\n      custTaxNo: new UntypedFormControl('', [Validators.required]),\n      custPhone1: new UntypedFormControl('', [Validators.required]),\n      custPhone2: new UntypedFormControl('', [Validators.required]),\n      custEmail: new UntypedFormControl('', [Validators.required]),\n      custAdd1: new UntypedFormControl('', [Validators.required]),\n      custAdd2: new UntypedFormControl('', [Validators.required]),\n      custAdd3: new UntypedFormControl('', [Validators.required]),\n      contactId: new UntypedFormControl('', [Validators.required]),\n      contactPerson: new UntypedFormControl('', [Validators.required]),\n      contactPhone1: new UntypedFormControl('', [Validators.required]),\n      contactPhone2: new UntypedFormControl('', [Validators.required]),\n      contactEmail: new UntypedFormControl('', [Validators.required]),\n      contactAddress1: new UntypedFormControl('', [Validators.required]),\n      contactAddress2: new UntypedFormControl('', [Validators.required]),\n      contactAddress3: new UntypedFormControl('', [Validators.required])\n    });\n  }\n};\nSuppliersDetailsComponent = __decorate([Component({\n  selector: 'app-suppliers-details',\n  templateUrl: './suppliers-details.component.html',\n  styleUrls: ['./suppliers-details.component.scss']\n})], SuppliersDetailsComponent);","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}