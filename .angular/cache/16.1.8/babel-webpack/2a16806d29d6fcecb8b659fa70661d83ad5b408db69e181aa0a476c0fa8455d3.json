{"ast":null,"code":"import { UntypedFormGroup, UntypedFormControl, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/finance/finance.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/material/snack-bar\";\nimport * as i4 from \"@angular/material/icon\";\nimport * as i5 from \"@angular/material/tabs\";\nimport * as i6 from \"@angular/material/form-field\";\nimport * as i7 from \"@angular/material/input\";\nimport * as i8 from \"@angular/material/select\";\nimport * as i9 from \"@angular/material/core\";\nimport * as i10 from \"@angular/forms\";\nconst _c0 = function () {\n  return [\"/supply-chain/supplier-list\"];\n};\nexport let SuppliersDetailsComponent = /*#__PURE__*/(() => {\n  class SuppliersDetailsComponent {\n    constructor(financeService, route, _snackBar) {\n      this.financeService = financeService;\n      this.route = route;\n      this._snackBar = _snackBar;\n      this.currentYear = new Date().getFullYear();\n      this.custForm = new UntypedFormGroup({\n        pcode: new UntypedFormControl('', [Validators.required]),\n        custName: new UntypedFormControl('', [Validators.required]),\n        custCR: new UntypedFormControl('', [Validators.required]),\n        custStatus: new UntypedFormControl('', [Validators.required]),\n        custTaxNo: new UntypedFormControl('', [Validators.required]),\n        custPhone1: new UntypedFormControl('', [Validators.required]),\n        custPhone2: new UntypedFormControl('', [Validators.required]),\n        custEmail: new UntypedFormControl('', [Validators.required]),\n        custAdd1: new UntypedFormControl('', [Validators.required]),\n        custAdd2: new UntypedFormControl('', [Validators.required]),\n        custAdd3: new UntypedFormControl('', [Validators.required]),\n        contactId: new UntypedFormControl('', [Validators.required]),\n        contactPerson: new UntypedFormControl('', [Validators.required]),\n        contactPhone1: new UntypedFormControl('', [Validators.required]),\n        contactPhone2: new UntypedFormControl('', [Validators.required]),\n        contactEmail: new UntypedFormControl('', [Validators.required]),\n        contactAddress1: new UntypedFormControl('', [Validators.required]),\n        contactAddress2: new UntypedFormControl('', [Validators.required]),\n        contactAddress3: new UntypedFormControl('', [Validators.required])\n      });\n    }\n    ngOnInit() {\n      if (this.route.snapshot.params.id === 'new') {\n        this.newForm();\n      } else {\n        this.getData(this.route.snapshot.params.id);\n      }\n    }\n    getData(pcode) {\n      this.refreshForm();\n      this.financeService.getSupplierDetailFromPcode(String(this.currentYear), pcode).subscribe(res => {\n        console.log(res);\n        this.financeService.getPartyDetailFromPCODE(pcode).subscribe(resp => {\n          console.log(resp);\n          this.custForm.patchValue({\n            pcode: res.recordset[0].PCODE,\n            custName: res.recordset[0].CUST_NAME,\n            custCR: res.recordset[0].CR_CPR,\n            custStatus: res.recordset[0].STATUS,\n            custTaxNo: res.recordset[0].TAX_1_NO,\n            custPhone1: res.recordset[0].PHONE1,\n            custPhone2: res.recordset[0].PHONE2,\n            custEmail: res.recordset[0].EMAIL,\n            custAdd1: res.recordset[0].ADD1,\n            custAdd2: res.recordset[0].ADD2,\n            custAdd3: res.recordset[0].ADD3,\n            contactId: resp.recordset[0].PARTY_ID,\n            contactPerson: resp.recordset[0].NAME,\n            contactPhone1: resp.recordset[0].PHONE1,\n            contactPhone2: resp.recordset[0].PHONE2,\n            contactEmail: resp.recordset[0].EMAIL_ID,\n            contactAddress1: resp.recordset[0].ADD1,\n            contactAddress2: resp.recordset[0].ADD2,\n            contactAddress3: resp.recordset[0].ADD3\n          });\n        }, err => {\n          console.log(err);\n          this.custForm.patchValue({\n            pcode: res.recordset[0].PCODE,\n            custName: res.recordset[0].CUST_NAME,\n            custCR: res.recordset[0].CR_CPR,\n            custStatus: res.recordset[0].STATUS,\n            custTaxNo: res.recordset[0].TAX_1_NO,\n            custPhone1: res.recordset[0].PHONE1,\n            custPhone2: res.recordset[0].PHONE2,\n            custEmail: res.recordset[0].EMAIL,\n            custAdd1: res.recordset[0].ADD1,\n            custAdd2: res.recordset[0].ADD2,\n            custAdd3: res.recordset[0].ADD3\n          });\n        });\n      });\n    }\n    newForm() {\n      this.financeService.getCustomerCount().subscribe(res => {\n        console.log(res);\n        this.financeService.getMaxParty().subscribe(resp => {\n          console.log(resp);\n          const pcode = 'L012-000' + res.recordset[0].COUNT;\n          const partyid = Number(resp.recordset[0].COUNT) + 1;\n          this.custForm = new UntypedFormGroup({\n            pcode: new UntypedFormControl(pcode, [Validators.required]),\n            custName: new UntypedFormControl('', [Validators.required]),\n            custCR: new UntypedFormControl('', [Validators.required]),\n            custStatus: new UntypedFormControl('', [Validators.required]),\n            custTaxNo: new UntypedFormControl('', [Validators.required]),\n            custPhone1: new UntypedFormControl('', [Validators.required]),\n            custPhone2: new UntypedFormControl('', [Validators.required]),\n            custEmail: new UntypedFormControl('', [Validators.required]),\n            custAdd1: new UntypedFormControl('', [Validators.required]),\n            custAdd2: new UntypedFormControl('', [Validators.required]),\n            custAdd3: new UntypedFormControl('', [Validators.required]),\n            contactId: new UntypedFormControl(String(partyid), [Validators.required]),\n            contactPerson: new UntypedFormControl('', [Validators.required]),\n            contactPhone1: new UntypedFormControl('', [Validators.required]),\n            contactPhone2: new UntypedFormControl('', [Validators.required]),\n            contactEmail: new UntypedFormControl('', [Validators.required]),\n            contactAddress1: new UntypedFormControl('', [Validators.required]),\n            contactAddress2: new UntypedFormControl('', [Validators.required]),\n            contactAddress3: new UntypedFormControl('', [Validators.required])\n          });\n        });\n      });\n    }\n    submitForm() {\n      const data = this.custForm.value;\n      this.financeService.getCustomerDetailFromPcode(String(this.currentYear), data.pcode).subscribe(res => {\n        console.log(res);\n        this.financeService.updateOPBAL(data.pcode, data.custName, data.custCR, 'S', data.custAdd1, data.custAdd2, data.custAdd3, data.custPhone1, data.custPhone2, data.custEmail, data.custStatus, String(this.currentYear), data.custTaxNo);\n      }, err => {\n        console.log(err);\n        this.financeService.postOPBAL(data.pcode, data.custName, data.custCR, 'S', data.custAdd1, data.custAdd2, data.custAdd3, data.custPhone1, data.custPhone2, data.custEmail, data.custStatus, String(this.currentYear), data.custTaxNo);\n      });\n      this.financeService.getPartyDetailFromPartyId(data.contactId).subscribe(res => {\n        console.log(res);\n        this.financeService.updateContact(data.contactId, data.contactPerson, 'S', data.contactAddress1, data.contactAddress2, data.contactAddress3, data.contactPhone1, data.contactPhone2, data.contactEmail, data.pcode);\n      }, err => {\n        console.log(err);\n        this.financeService.postContact(data.contactId, data.contactPerson, 'S', data.contactAddress1, data.contactAddress2, data.contactAddress3, data.contactPhone1, data.contactPhone2, data.contactEmail, data.pcode);\n      });\n      this._snackBar.open(\"Data Successfully Updated!\", \"OK\");\n      this.getData(data.pcode);\n    }\n    copyToContact() {\n      const data = this.custForm.value;\n      this.custForm.patchValue({\n        contactPerson: data.custName,\n        contactPhone1: data.custPhone1,\n        contactPhone2: data.custPhone2,\n        contactEmail: data.custEmail,\n        contactAddress1: data.custAdd1,\n        contactAddress2: data.custAdd2,\n        contactAddress3: data.custAdd3\n      });\n    }\n    refreshForm() {\n      this.custForm = new UntypedFormGroup({\n        pcode: new UntypedFormControl('', [Validators.required]),\n        custName: new UntypedFormControl('', [Validators.required]),\n        custCR: new UntypedFormControl('', [Validators.required]),\n        custStatus: new UntypedFormControl('', [Validators.required]),\n        custTaxNo: new UntypedFormControl('', [Validators.required]),\n        custPhone1: new UntypedFormControl('', [Validators.required]),\n        custPhone2: new UntypedFormControl('', [Validators.required]),\n        custEmail: new UntypedFormControl('', [Validators.required]),\n        custAdd1: new UntypedFormControl('', [Validators.required]),\n        custAdd2: new UntypedFormControl('', [Validators.required]),\n        custAdd3: new UntypedFormControl('', [Validators.required]),\n        contactId: new UntypedFormControl('', [Validators.required]),\n        contactPerson: new UntypedFormControl('', [Validators.required]),\n        contactPhone1: new UntypedFormControl('', [Validators.required]),\n        contactPhone2: new UntypedFormControl('', [Validators.required]),\n        contactEmail: new UntypedFormControl('', [Validators.required]),\n        contactAddress1: new UntypedFormControl('', [Validators.required]),\n        contactAddress2: new UntypedFormControl('', [Validators.required]),\n        contactAddress3: new UntypedFormControl('', [Validators.required])\n      });\n    }\n    static #_ = this.ɵfac = function SuppliersDetailsComponent_Factory(t) {\n      return new (t || SuppliersDetailsComponent)(i0.ɵɵdirectiveInject(i1.FinanceService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i3.MatSnackBar));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: SuppliersDetailsComponent,\n      selectors: [[\"app-suppliers-details\"]],\n      decls: 141,\n      vars: 3,\n      consts: [[1, \"container-fluid\"], [1, \"row\", \"no-gutters\"], [1, \"visualization-heading\", \"col-12\"], [1, \"heading-info\", \"row\"], [1, \"col-6\"], [1, \"heading-title\"], [1, \"row\"], [1, \"col\"], [\"title\", \"New Supplier\", 1, \"btn-primary\", \"text-white\", \"btn\", \"btn-block\", \"btn-sm\", 3, \"click\"], [\"title\", \"Copy to Contact\", 1, \"btn-warning\", \"text-white\", \"btn\", \"btn-block\", \"btn-sm\", 3, \"click\"], [\"title\", \"Submit Supplier\", 1, \"btn-success\", \"text-white\", \"btn\", \"btn-block\", \"btn-sm\", 3, \"click\"], [\"title\", \"Refresh form\", 1, \"btn-danger\", \"text-white\", \"btn\", \"btn-block\", \"btn-sm\", 3, \"click\"], [\"title\", \"Return to Supplier List\", 1, \"btn-dark\", \"text-white\", \"btn\", \"btn-block\", \"btn-sm\", 3, \"routerLink\"], [1, \"col-12\"], [1, \"form-container\", 3, \"formGroup\"], [1, \"col-3\"], [1, \"full-width\"], [\"matInput\", \"\", \"formControlName\", \"pcode\", \"matInput\", \"\", \"required\", \"\", 3, \"keydown.enter\"], [\"pcode\", \"\"], [\"formControlName\", \"custName\", \"matInput\", \"\", \"required\", \"\"], [\"formControlName\", \"custCR\", \"matInput\", \"\", \"required\", \"\"], [\"formControlName\", \"custStatus\"], [\"value\", \"A\"], [\"value\", \"I\"], [\"formControlName\", \"custTaxNo\", \"matInput\", \"\", \"required\", \"\"], [\"formControlName\", \"custPhone1\", \"matInput\", \"\"], [\"formControlName\", \"custPhone2\", \"matInput\", \"\"], [\"formControlName\", \"custEmail\", \"matInput\", \"\"], [1, \"col-4\"], [\"formControlName\", \"custAdd1\", \"matInput\", \"\"], [\"formControlName\", \"custAdd2\", \"matInput\", \"\"], [\"formControlName\", \"custAdd3\", \"matInput\", \"\"], [\"label\", \"Contact Details\"], [\"matInput\", \"\", \"rquired\", \"\", \"formControlName\", \"contactId\"], [1, \"col-9\"], [\"matInput\", \"\", \"required\", \"\", \"formControlName\", \"contactPerson\"], [\"matInput\", \"\", \"formControlName\", \"contactPhone1\"], [\"matInput\", \"\", \"formControlName\", \"contactPhone2\"], [\"matInput\", \"\", \"formControlName\", \"contactEmail\"], [\"matInput\", \"\", \"required\", \"\", \"formControlName\", \"contactAddress1\"], [\"matInput\", \"\", \"required\", \"\", \"formControlName\", \"contactAddress2\"], [\"matInput\", \"\", \"required\", \"\", \"formControlName\", \"contactAddress3\"]],\n      template: function SuppliersDetailsComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"h3\", 5);\n          i0.ɵɵtext(6, \"Supplier Details\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(7, \"div\", 4)(8, \"div\", 6)(9, \"div\", 7)(10, \"button\", 8);\n          i0.ɵɵlistener(\"click\", function SuppliersDetailsComponent_Template_button_click_10_listener() {\n            return ctx.newForm();\n          });\n          i0.ɵɵelementStart(11, \"mat-icon\");\n          i0.ɵɵtext(12, \"add\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(13, \"div\", 7)(14, \"button\", 9);\n          i0.ɵɵlistener(\"click\", function SuppliersDetailsComponent_Template_button_click_14_listener() {\n            return ctx.copyToContact();\n          });\n          i0.ɵɵelementStart(15, \"mat-icon\");\n          i0.ɵɵtext(16, \"play_for_work\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(17, \"div\", 7)(18, \"button\", 10);\n          i0.ɵɵlistener(\"click\", function SuppliersDetailsComponent_Template_button_click_18_listener() {\n            return ctx.submitForm();\n          });\n          i0.ɵɵelementStart(19, \"mat-icon\");\n          i0.ɵɵtext(20, \"note_add\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(21, \"div\", 7)(22, \"button\", 11);\n          i0.ɵɵlistener(\"click\", function SuppliersDetailsComponent_Template_button_click_22_listener() {\n            return ctx.refreshForm();\n          });\n          i0.ɵɵelementStart(23, \"mat-icon\");\n          i0.ɵɵtext(24, \"refresh\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(25, \"div\", 7)(26, \"button\", 12)(27, \"mat-icon\");\n          i0.ɵɵtext(28, \"arrow_back\");\n          i0.ɵɵelementEnd()()()()()();\n          i0.ɵɵelement(29, \"hr\");\n          i0.ɵɵelementStart(30, \"div\", 13)(31, \"form\", 14)(32, \"div\", 6)(33, \"div\", 15)(34, \"mat-form-field\", 16)(35, \"mat-label\");\n          i0.ɵɵtext(36, \"Supplier Code \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(37, \"input\", 17, 18);\n          i0.ɵɵlistener(\"keydown.enter\", function SuppliersDetailsComponent_Template_input_keydown_enter_37_listener() {\n            i0.ɵɵrestoreView(_r1);\n            const _r0 = i0.ɵɵreference(38);\n            return i0.ɵɵresetView(ctx.getSupplierDetails(_r0.value));\n          });\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(39, \"div\", 15)(40, \"mat-form-field\", 16)(41, \"mat-label\");\n          i0.ɵɵtext(42, \"Name\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(43, \"input\", 19);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(44, \"div\", 15)(45, \"mat-form-field\", 16)(46, \"mat-label\");\n          i0.ɵɵtext(47, \"CR/CPR\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(48, \"input\", 20);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(49, \"div\", 15)(50, \"mat-form-field\", 16)(51, \"mat-label\");\n          i0.ɵɵtext(52, \"Active\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(53, \"mat-select\", 21)(54, \"mat-option\", 22);\n          i0.ɵɵtext(55, \"True\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(56, \"mat-option\", 23);\n          i0.ɵɵtext(57, \"False\");\n          i0.ɵɵelementEnd()()()()();\n          i0.ɵɵelementStart(58, \"div\", 6)(59, \"div\", 15)(60, \"mat-form-field\", 16)(61, \"mat-label\");\n          i0.ɵɵtext(62, \"TAX NO\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(63, \"input\", 24);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(64, \"div\", 15)(65, \"mat-form-field\", 16)(66, \"mat-label\");\n          i0.ɵɵtext(67, \"Phone 1\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(68, \"input\", 25);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(69, \"div\", 15)(70, \"mat-form-field\", 16)(71, \"mat-label\");\n          i0.ɵɵtext(72, \"Phone 2\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(73, \"input\", 26);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(74, \"div\", 15)(75, \"mat-form-field\", 16)(76, \"mat-label\");\n          i0.ɵɵtext(77, \"Email\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(78, \"input\", 27);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(79, \"div\", 6)(80, \"div\", 28)(81, \"mat-form-field\", 16)(82, \"mat-label\");\n          i0.ɵɵtext(83, \"Address 1\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(84, \"input\", 29);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(85, \"div\", 28)(86, \"mat-form-field\", 16)(87, \"mat-label\");\n          i0.ɵɵtext(88, \"Address 2\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(89, \"input\", 30);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(90, \"div\", 28)(91, \"mat-form-field\", 16)(92, \"mat-label\");\n          i0.ɵɵtext(93, \"Address 3\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(94, \"input\", 31);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(95, \"mat-tab-group\")(96, \"mat-tab\", 32);\n          i0.ɵɵelement(97, \"br\");\n          i0.ɵɵelementStart(98, \"div\", 6)(99, \"div\", 15)(100, \"mat-form-field\", 16)(101, \"mat-label\");\n          i0.ɵɵtext(102, \"Contact ID\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(103, \"input\", 33);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(104, \"div\", 34)(105, \"mat-form-field\", 16)(106, \"mat-label\");\n          i0.ɵɵtext(107, \"Contact Name\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(108, \"input\", 35);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(109, \"div\", 6)(110, \"div\", 28)(111, \"mat-form-field\", 16)(112, \"mat-label\");\n          i0.ɵɵtext(113, \"Phone 1\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(114, \"input\", 36);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(115, \"div\", 28)(116, \"mat-form-field\", 16)(117, \"mat-label\");\n          i0.ɵɵtext(118, \"Phone 2\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(119, \"input\", 37);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(120, \"div\", 28)(121, \"mat-form-field\", 16)(122, \"mat-label\");\n          i0.ɵɵtext(123, \"Email\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(124, \"input\", 38);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(125, \"div\", 6)(126, \"div\", 28)(127, \"mat-form-field\", 16)(128, \"mat-label\");\n          i0.ɵɵtext(129, \"Address 1\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(130, \"input\", 39);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(131, \"div\", 28)(132, \"mat-form-field\", 16)(133, \"mat-label\");\n          i0.ɵɵtext(134, \"Address 2\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(135, \"input\", 40);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(136, \"div\", 28)(137, \"mat-form-field\", 16)(138, \"mat-label\");\n          i0.ɵɵtext(139, \"Address 3\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(140, \"input\", 41);\n          i0.ɵɵelementEnd()()()()()()()()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(26);\n          i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(2, _c0));\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"formGroup\", ctx.custForm);\n        }\n      },\n      dependencies: [i4.MatIcon, i5.MatTab, i5.MatTabGroup, i6.MatFormField, i6.MatLabel, i7.MatInput, i8.MatSelect, i9.MatOption, i10.ɵNgNoValidate, i10.DefaultValueAccessor, i10.NgControlStatus, i10.NgControlStatusGroup, i10.RequiredValidator, i10.FormGroupDirective, i10.FormControlName, i2.RouterLink],\n      styles: [\".full-width[_ngcontent-%COMP%]{width:100%;height:40%}mat-form-field[_ngcontent-%COMP%]{font-size:13px;width:100%;height:75%}.container-fluid[_ngcontent-%COMP%]{color:#00008b;background:rgb(251,252,249)}.highlight[_ngcontent-%COMP%]{background:lightgray}tr[_ngcontent-%COMP%]:focus{outline:none}\"]\n    });\n  }\n  return SuppliersDetailsComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}