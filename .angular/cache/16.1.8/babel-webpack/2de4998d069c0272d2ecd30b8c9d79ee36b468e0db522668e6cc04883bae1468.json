{"ast":null,"code":"import { UntypedFormControl, UntypedFormGroup, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/finance/finance.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/material/snack-bar\";\nimport * as i4 from \"@angular/material/icon\";\nimport * as i5 from \"@angular/material/tabs\";\nimport * as i6 from \"@angular/material/form-field\";\nimport * as i7 from \"@angular/material/input\";\nimport * as i8 from \"@angular/material/select\";\nimport * as i9 from \"@angular/material/core\";\nimport * as i10 from \"@angular/forms\";\nconst _c0 = function () {\n  return [\"/crm/customer-list\"];\n};\nexport let CustomerDetailsComponent = /*#__PURE__*/(() => {\n  class CustomerDetailsComponent {\n    constructor(financeService, route, _snackBar) {\n      this.financeService = financeService;\n      this.route = route;\n      this._snackBar = _snackBar;\n      this.currentYear = new Date().getFullYear();\n      this.custForm = new UntypedFormGroup({\n        pcode: new UntypedFormControl('', [Validators.required]),\n        custName: new UntypedFormControl('', [Validators.required]),\n        custCR: new UntypedFormControl('', [Validators.required]),\n        custStatus: new UntypedFormControl('', [Validators.required]),\n        custTaxNo: new UntypedFormControl('', [Validators.required]),\n        custPhone1: new UntypedFormControl('', [Validators.required]),\n        custPhone2: new UntypedFormControl('', [Validators.required]),\n        custEmail: new UntypedFormControl('', [Validators.required]),\n        custAdd1: new UntypedFormControl('', [Validators.required]),\n        custAdd2: new UntypedFormControl('', [Validators.required]),\n        custAdd3: new UntypedFormControl('', [Validators.required]),\n        contactId: new UntypedFormControl('', [Validators.required]),\n        contactPerson: new UntypedFormControl('', [Validators.required]),\n        contactPhone1: new UntypedFormControl('', [Validators.required]),\n        contactPhone2: new UntypedFormControl('', [Validators.required]),\n        contactEmail: new UntypedFormControl('', [Validators.required]),\n        contactAddress1: new UntypedFormControl('', [Validators.required]),\n        contactAddress2: new UntypedFormControl('', [Validators.required]),\n        contactAddress3: new UntypedFormControl('', [Validators.required])\n      });\n    }\n    ngOnInit() {\n      if (this.route.snapshot.params.id === 'new') {\n        this.newForm();\n      } else {\n        this.getData(this.route.snapshot.params.id);\n      }\n    }\n    getData(pcode) {\n      this.refreshForm();\n      this.financeService.getCustomerDetailFromPcode(String(this.currentYear), pcode).subscribe(res => {\n        console.log(res);\n        this.financeService.getPartyDetailFromPCODE(pcode).subscribe(resp => {\n          console.log(resp);\n          this.custForm.patchValue({\n            pcode: res.recordset[0].PCODE,\n            custName: res.recordset[0].CUST_NAME,\n            custCR: res.recordset[0].CR_CPR,\n            custStatus: res.recordset[0].STATUS,\n            custTaxNo: res.recordset[0].TAX_1_NO,\n            custPhone1: res.recordset[0].PHONE1,\n            custPhone2: res.recordset[0].PHONE2,\n            custEmail: res.recordset[0].EMAIL,\n            custAdd1: res.recordset[0].ADD1,\n            custAdd2: res.recordset[0].ADD2,\n            custAdd3: res.recordset[0].ADD3,\n            contactId: resp.recordset[0].PARTY_ID,\n            contactPerson: resp.recordset[0].NAME,\n            contactPhone1: resp.recordset[0].PHONE1,\n            contactPhone2: resp.recordset[0].PHONE2,\n            contactEmail: resp.recordset[0].EMAIL_ID,\n            contactAddress1: resp.recordset[0].ADD1,\n            contactAddress2: resp.recordset[0].ADD2,\n            contactAddress3: resp.recordset[0].ADD3\n          });\n        }, err => {\n          console.log(err);\n          this.custForm.patchValue({\n            pcode: res.recordset[0].PCODE,\n            custName: res.recordset[0].CUST_NAME,\n            custCR: res.recordset[0].CR_CPR,\n            custStatus: res.recordset[0].STATUS,\n            custTaxNo: res.recordset[0].TAX_1_NO,\n            custPhone1: res.recordset[0].PHONE1,\n            custPhone2: res.recordset[0].PHONE2,\n            custEmail: res.recordset[0].EMAIL,\n            custAdd1: res.recordset[0].ADD1,\n            custAdd2: res.recordset[0].ADD2,\n            custAdd3: res.recordset[0].ADD3\n          });\n        });\n      });\n    }\n    newForm() {\n      this.financeService.getCustomerCount().subscribe(res => {\n        console.log(res);\n        this.financeService.getMaxParty().subscribe(resp => {\n          console.log(resp);\n          const pcode = 'A201-000' + res.recordset[0].COUNT;\n          const partyid = Number(resp.recordset[0].COUNT) + 1;\n          this.custForm = new UntypedFormGroup({\n            pcode: new UntypedFormControl(pcode, [Validators.required]),\n            custName: new UntypedFormControl('', [Validators.required]),\n            custCR: new UntypedFormControl('', [Validators.required]),\n            custStatus: new UntypedFormControl('', [Validators.required]),\n            custTaxNo: new UntypedFormControl('', [Validators.required]),\n            custPhone1: new UntypedFormControl('', [Validators.required]),\n            custPhone2: new UntypedFormControl('', [Validators.required]),\n            custEmail: new UntypedFormControl('', [Validators.required]),\n            custAdd1: new UntypedFormControl('', [Validators.required]),\n            custAdd2: new UntypedFormControl('', [Validators.required]),\n            custAdd3: new UntypedFormControl('', [Validators.required]),\n            contactId: new UntypedFormControl(String(partyid), [Validators.required]),\n            contactPerson: new UntypedFormControl('', [Validators.required]),\n            contactPhone1: new UntypedFormControl('', [Validators.required]),\n            contactPhone2: new UntypedFormControl('', [Validators.required]),\n            contactEmail: new UntypedFormControl('', [Validators.required]),\n            contactAddress1: new UntypedFormControl('', [Validators.required]),\n            contactAddress2: new UntypedFormControl('', [Validators.required]),\n            contactAddress3: new UntypedFormControl('', [Validators.required])\n          });\n        });\n      });\n    }\n    submitForm() {\n      const data = this.custForm.value;\n      this.financeService.getCustomerDetailFromPcode(String(this.currentYear), data.pcode).subscribe(res => {\n        console.log(res);\n        this.financeService.updateOPBAL(data.pcode, data.custName, data.custCR, 'C', data.custAdd1, data.custAdd2, data.custAdd3, data.custPhone1, data.custPhone2, data.custEmail, data.custStatus, String(this.currentYear), data.custTaxNo);\n      }, err => {\n        console.log(err);\n        this.financeService.postOPBAL(data.pcode, data.custName, data.custCR, 'C', data.custAdd1, data.custAdd2, data.custAdd3, data.custPhone1, data.custPhone2, data.custEmail, data.custStatus, String(this.currentYear), data.custTaxNo);\n      });\n      this.financeService.getPartyDetailFromPartyId(data.contactId).subscribe(res => {\n        console.log(res);\n        this.financeService.updateContact(data.contactId, data.contactPerson, 'C', data.contactAddress1, data.contactAddress2, data.contactAddress3, data.contactPhone1, data.contactPhone2, data.contactEmail, data.pcode);\n      }, err => {\n        console.log(err);\n        this.financeService.postContact(data.contactId, data.contactPerson, 'C', data.contactAddress1, data.contactAddress2, data.contactAddress3, data.contactPhone1, data.contactPhone2, data.contactEmail, data.pcode);\n      });\n      this._snackBar.open(\"Data Successfully Updated!\", \"OK\");\n      this.getData(data.pcode);\n    }\n    copyToContact() {\n      const data = this.custForm.value;\n      this.custForm.patchValue({\n        contactPerson: data.custName,\n        contactPhone1: data.custPhone1,\n        contactPhone2: data.custPhone2,\n        contactEmail: data.custEmail,\n        contactAddress1: data.custAdd1,\n        contactAddress2: data.custAdd2,\n        contactAddress3: data.custAdd3\n      });\n    }\n    refreshForm() {\n      this.custForm = new UntypedFormGroup({\n        pcode: new UntypedFormControl('', [Validators.required]),\n        custName: new UntypedFormControl('', [Validators.required]),\n        custCR: new UntypedFormControl('', [Validators.required]),\n        custStatus: new UntypedFormControl('', [Validators.required]),\n        custTaxNo: new UntypedFormControl('', [Validators.required]),\n        custPhone1: new UntypedFormControl('', [Validators.required]),\n        custPhone2: new UntypedFormControl('', [Validators.required]),\n        custEmail: new UntypedFormControl('', [Validators.required]),\n        custAdd1: new UntypedFormControl('', [Validators.required]),\n        custAdd2: new UntypedFormControl('', [Validators.required]),\n        custAdd3: new UntypedFormControl('', [Validators.required]),\n        contactId: new UntypedFormControl('', [Validators.required]),\n        contactPerson: new UntypedFormControl('', [Validators.required]),\n        contactPhone1: new UntypedFormControl('', [Validators.required]),\n        contactPhone2: new UntypedFormControl('', [Validators.required]),\n        contactEmail: new UntypedFormControl('', [Validators.required]),\n        contactAddress1: new UntypedFormControl('', [Validators.required]),\n        contactAddress2: new UntypedFormControl('', [Validators.required]),\n        contactAddress3: new UntypedFormControl('', [Validators.required])\n      });\n    }\n    static #_ = this.ɵfac = function CustomerDetailsComponent_Factory(t) {\n      return new (t || CustomerDetailsComponent)(i0.ɵɵdirectiveInject(i1.FinanceService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i3.MatSnackBar));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: CustomerDetailsComponent,\n      selectors: [[\"app-customer-details\"]],\n      decls: 142,\n      vars: 3,\n      consts: [[1, \"container-fluid\"], [1, \"row\", \"no-gutters\"], [1, \"visualization-heading\", \"col-12\"], [1, \"heading-info\", \"row\"], [1, \"col-6\"], [1, \"heading-title\"], [1, \"row\"], [1, \"col\"], [\"title\", \"New Customer\", 1, \"btn-primary\", \"text-white\", \"btn\", \"btn-block\", \"btn-sm\", 3, \"click\"], [\"title\", \"Copy to Contact\", 1, \"btn-warning\", \"text-white\", \"btn\", \"btn-block\", \"btn-sm\", 3, \"click\"], [\"title\", \"Submit Customer\", 1, \"btn-success\", \"text-white\", \"btn\", \"btn-block\", \"btn-sm\", 3, \"click\"], [\"title\", \"Refresh form\", 1, \"btn-danger\", \"text-white\", \"btn\", \"btn-block\", \"btn-sm\", 3, \"click\"], [\"title\", \"Return to Customer List\", 1, \"btn-dark\", \"text-white\", \"btn\", \"btn-block\", \"btn-sm\", 3, \"routerLink\"], [1, \"col-12\"], [1, \"form-container\", 3, \"formGroup\"], [1, \"col-3\"], [1, \"full-width\"], [\"matInput\", \"\", \"formControlName\", \"pcode\", \"matInput\", \"\", \"required\", \"\", 3, \"keydown.enter\"], [\"pcode\", \"\"], [\"formControlName\", \"custName\", \"matInput\", \"\", \"required\", \"\"], [\"formControlName\", \"custCR\", \"matInput\", \"\", \"required\", \"\"], [\"formControlName\", \"custStatus\"], [\"value\", \"A\"], [\"value\", \"I\"], [\"formControlName\", \"custTaxNo\", \"matInput\", \"\", \"required\", \"\"], [\"formControlName\", \"custPhone1\", \"matInput\", \"\"], [\"formControlName\", \"custPhone2\", \"matInput\", \"\"], [\"formControlName\", \"custEmail\", \"matInput\", \"\"], [1, \"col-4\"], [\"formControlName\", \"custAdd1\", \"matInput\", \"\"], [\"formControlName\", \"custAdd2\", \"matInput\", \"\"], [\"formControlName\", \"custAdd3\", \"matInput\", \"\"], [\"label\", \"Contact Details\"], [\"matInput\", \"\", \"rquired\", \"\", \"formControlName\", \"contactId\"], [1, \"col-9\"], [\"matInput\", \"\", \"required\", \"\", \"formControlName\", \"contactPerson\"], [\"matInput\", \"\", \"formControlName\", \"contactPhone1\"], [\"matInput\", \"\", \"formControlName\", \"contactPhone2\"], [\"matInput\", \"\", \"formControlName\", \"contactEmail\"], [\"matInput\", \"\", \"required\", \"\", \"formControlName\", \"contactAddress1\"], [\"matInput\", \"\", \"required\", \"\", \"formControlName\", \"contactAddress2\"], [\"matInput\", \"\", \"required\", \"\", \"formControlName\", \"contactAddress3\"]],\n      template: function CustomerDetailsComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"h3\", 5);\n          i0.ɵɵtext(6, \"Customer Details\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(7, \"div\", 4)(8, \"div\", 6)(9, \"div\", 7)(10, \"button\", 8);\n          i0.ɵɵlistener(\"click\", function CustomerDetailsComponent_Template_button_click_10_listener() {\n            return ctx.newForm();\n          });\n          i0.ɵɵelementStart(11, \"mat-icon\");\n          i0.ɵɵtext(12, \"add\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(13, \"div\", 7)(14, \"button\", 9);\n          i0.ɵɵlistener(\"click\", function CustomerDetailsComponent_Template_button_click_14_listener() {\n            return ctx.copyToContact();\n          });\n          i0.ɵɵelementStart(15, \"mat-icon\");\n          i0.ɵɵtext(16, \"play_for_work\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(17, \"div\", 7)(18, \"button\", 10);\n          i0.ɵɵlistener(\"click\", function CustomerDetailsComponent_Template_button_click_18_listener() {\n            return ctx.submitForm();\n          });\n          i0.ɵɵelementStart(19, \"mat-icon\");\n          i0.ɵɵtext(20, \"note_add\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(21, \"div\", 7)(22, \"button\", 11);\n          i0.ɵɵlistener(\"click\", function CustomerDetailsComponent_Template_button_click_22_listener() {\n            return ctx.refreshForm();\n          });\n          i0.ɵɵelementStart(23, \"mat-icon\");\n          i0.ɵɵtext(24, \"refresh\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(25, \"div\", 7)(26, \"button\", 12)(27, \"mat-icon\");\n          i0.ɵɵtext(28, \"arrow_back\");\n          i0.ɵɵelementEnd()()()()()()()();\n          i0.ɵɵelement(29, \"hr\");\n          i0.ɵɵelementStart(30, \"div\", 6)(31, \"div\", 13)(32, \"form\", 14)(33, \"div\", 6)(34, \"div\", 15)(35, \"mat-form-field\", 16)(36, \"mat-label\");\n          i0.ɵɵtext(37, \"Customer Code \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(38, \"input\", 17, 18);\n          i0.ɵɵlistener(\"keydown.enter\", function CustomerDetailsComponent_Template_input_keydown_enter_38_listener() {\n            i0.ɵɵrestoreView(_r1);\n            const _r0 = i0.ɵɵreference(39);\n            return i0.ɵɵresetView(ctx.getCustomerDetails(_r0.value));\n          });\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(40, \"div\", 15)(41, \"mat-form-field\", 16)(42, \"mat-label\");\n          i0.ɵɵtext(43, \"Name\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(44, \"input\", 19);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(45, \"div\", 15)(46, \"mat-form-field\", 16)(47, \"mat-label\");\n          i0.ɵɵtext(48, \"CR/CPR\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(49, \"input\", 20);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(50, \"div\", 15)(51, \"mat-form-field\", 16)(52, \"mat-label\");\n          i0.ɵɵtext(53, \"Active\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(54, \"mat-select\", 21)(55, \"mat-option\", 22);\n          i0.ɵɵtext(56, \"True\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(57, \"mat-option\", 23);\n          i0.ɵɵtext(58, \"False\");\n          i0.ɵɵelementEnd()()()()();\n          i0.ɵɵelementStart(59, \"div\", 6)(60, \"div\", 15)(61, \"mat-form-field\", 16)(62, \"mat-label\");\n          i0.ɵɵtext(63, \"TAX NO\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(64, \"input\", 24);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(65, \"div\", 15)(66, \"mat-form-field\", 16)(67, \"mat-label\");\n          i0.ɵɵtext(68, \"Phone 1\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(69, \"input\", 25);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(70, \"div\", 15)(71, \"mat-form-field\", 16)(72, \"mat-label\");\n          i0.ɵɵtext(73, \"Phone 2\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(74, \"input\", 26);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(75, \"div\", 15)(76, \"mat-form-field\", 16)(77, \"mat-label\");\n          i0.ɵɵtext(78, \"Email\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(79, \"input\", 27);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(80, \"div\", 6)(81, \"div\", 28)(82, \"mat-form-field\", 16)(83, \"mat-label\");\n          i0.ɵɵtext(84, \"Address 1\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(85, \"input\", 29);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(86, \"div\", 28)(87, \"mat-form-field\", 16)(88, \"mat-label\");\n          i0.ɵɵtext(89, \"Address 2\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(90, \"input\", 30);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(91, \"div\", 28)(92, \"mat-form-field\", 16)(93, \"mat-label\");\n          i0.ɵɵtext(94, \"Address 3\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(95, \"input\", 31);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(96, \"mat-tab-group\")(97, \"mat-tab\", 32);\n          i0.ɵɵelement(98, \"br\");\n          i0.ɵɵelementStart(99, \"div\", 6)(100, \"div\", 15)(101, \"mat-form-field\", 16)(102, \"mat-label\");\n          i0.ɵɵtext(103, \"Contact ID\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(104, \"input\", 33);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(105, \"div\", 34)(106, \"mat-form-field\", 16)(107, \"mat-label\");\n          i0.ɵɵtext(108, \"Contact Name\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(109, \"input\", 35);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(110, \"div\", 6)(111, \"div\", 28)(112, \"mat-form-field\", 16)(113, \"mat-label\");\n          i0.ɵɵtext(114, \"Phone 1\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(115, \"input\", 36);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(116, \"div\", 28)(117, \"mat-form-field\", 16)(118, \"mat-label\");\n          i0.ɵɵtext(119, \"Phone 2\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(120, \"input\", 37);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(121, \"div\", 28)(122, \"mat-form-field\", 16)(123, \"mat-label\");\n          i0.ɵɵtext(124, \"Email\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(125, \"input\", 38);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(126, \"div\", 6)(127, \"div\", 28)(128, \"mat-form-field\", 16)(129, \"mat-label\");\n          i0.ɵɵtext(130, \"Address 1\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(131, \"input\", 39);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(132, \"div\", 28)(133, \"mat-form-field\", 16)(134, \"mat-label\");\n          i0.ɵɵtext(135, \"Address 2\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(136, \"input\", 40);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(137, \"div\", 28)(138, \"mat-form-field\", 16)(139, \"mat-label\");\n          i0.ɵɵtext(140, \"Address 3\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(141, \"input\", 41);\n          i0.ɵɵelementEnd()()()()()()()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(26);\n          i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(2, _c0));\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"formGroup\", ctx.custForm);\n        }\n      },\n      dependencies: [i4.MatIcon, i5.MatTab, i5.MatTabGroup, i6.MatFormField, i6.MatLabel, i7.MatInput, i8.MatSelect, i9.MatOption, i10.ɵNgNoValidate, i10.DefaultValueAccessor, i10.NgControlStatus, i10.NgControlStatusGroup, i10.RequiredValidator, i10.FormGroupDirective, i10.FormControlName, i2.RouterLink],\n      styles: [\".full-width[_ngcontent-%COMP%]{width:100%;height:40%}mat-form-field[_ngcontent-%COMP%]{font-size:13px;width:100%;height:75%}input[_ngcontent-%COMP%]{font-size:13px;height:75%}.container-fluid[_ngcontent-%COMP%]{color:#00008b;background:rgb(251,252,249)}.highlight[_ngcontent-%COMP%]{background:lightgray}tr[_ngcontent-%COMP%]:focus{outline:none}\"]\n    });\n  }\n  return CustomerDetailsComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}